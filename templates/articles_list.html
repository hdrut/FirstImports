{% extends "base.html" %}
{% block content %}
<h2>Artículos / Servicios</h2>

{% if user.rol == "admin" %}
<form class="card form" method="post" action="/articulos/nuevo">
  <div class="grid2">
    <div>
      <label>Nombre</label>
      <input name="nombre" required placeholder="Ej: Kit 4 cámaras / Instalación alarma">
    </div>
    <div>
      <label>Categoría</label>
      <input name="categoria" placeholder="Cámaras / Alarmas / Mano de obra / Accesorios">
    </div>
  </div>
  <button class="btn" type="submit">Crear</button>
</form>
{% endif %}

<div class="card">
  <table class="table">
    <thead><tr><th>Nombre</th><th>Categoría</th><th>Estado</th><th></th></tr></thead>
    <tbody>
      {% for a in articulos %}
      <tr>
        <td>{{ a.nombre }}</td>
        <td>{{ a.categoria }}</td>
        <td>{{ "Activo" if a.activo else "Inactivo" }}</td>
        <td class="right">
          {% if user.rol == "admin" %}
            <div style="display:flex; gap:8px; align-items:center; flex-wrap:nowrap;">
              <a href="/articulos/{{ a.id }}/editar" class="btn small secondary" style="white-space:nowrap;">
                Editar
              </a>
        
              <form action="/articulos/{{ a.id }}/toggle" method="post" style="display:inline; margin:0;">
                <button
                  class="btn small"
                  type="submit"
                  style="width:auto; padding-left:10px; padding-right:10px; white-space:nowrap;"
                >
                  {{ "Desactivar" if a.activo else "Activar" }}
                </button>
              </form>
            </div>
          {% endif %}
          
          
        </td>
      </tr>
      {% else %}
      <tr><td colspan="4" class="muted">No hay artículos aún.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
